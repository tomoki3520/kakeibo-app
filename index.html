<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>家計簿アプリ</title>

  <link rel="stylesheet" href="style.css">

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <link rel="manifest" href="/manifest.json">

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="家計簿">
  <link rel="apple-touch-icon" href="/icon-192x192.png">

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <link rel="icon" type="image/png" href="/icon-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/icon-512x512.png" sizes="512x512">

</head>
<body>
  <h1 id="top">家計簿</h1>
  <form id="expense-form">
    <label>種別：
      <select id="type" required>
        <option value="">選択してください</option>
        <option value="支出">支出</option>
        <option value="収入">収入</option>
      </select>
    </label>

    <label>日付：
      <input type="date" id="date" required />
    </label>

    <label>カテゴリ：
      <select id="category" required>
        <option value="">まず種別を選んでください</option>
      </select>
    </label>

    <label>金額（円）：
      <input type="number" id="amount" required min="0" />
    </label>

    <label class="form-group-relative">メモ：
      <input type="text" id="note" list="memo-suggestions" />
      <datalist id="memo-suggestions"></datalist>
    </label>

    <label>タグ（カンマ区切り）：
      <input type="text" id="tags" placeholder="例: 食事,外食,ランチ" />
    </label>

    <button type="submit">追加</button>
  </form>

  <h2>CSVデータのインポート</h2>
  <div class="import-section">
    <label for="csvFileInput">
      CSVファイルを選択してインポート:
      <input type="file" id="csvFileInput" accept=".csv"/>
    </label>
    <button type="button" id="importCsvBtn">CSVをインポート</button>
  </div>

  <h2 id="budget-section-h2">予算設定</h2>
  <div class="budget-section">
    <h3>月間予算を設定</h3>
    <label>カテゴリ：
      <select id="budgetCategorySelect" required>
        </select>
    </label>
    <label>予算額（円）：
      <input type="number" id="budgetAmountInput" required min="0" />
    </label>
    <button type="button" id="setBudgetBtn" class="budget-btn">予算を設定</button>

    <h3>現在の予算設定</h3>
    <ul id="budgetList">
      </ul>
  </div>

  <h2 id="recurring-entry-section-h2">定期的な記録の登録</h2>
  <div class="recurring-entry-section">
    <label>種別：
      <select id="recurringType" required>
        <option value="">選択してください</option>
        <option value="支出">支出</option>
        <option value="収入">収入</option>
      </select>
    </label>
    <label>カテゴリ：
      <select id="recurringCategory" required>
        </select>
    </label>
    <label>金額（円）：
      <input type="number" id="recurringAmount" required min="0" />
    </label>
    <label>メモ：
      <input type="text" id="recurringNote" />
    </label>
    <label>追加日（毎月）：
      <input type="number" id="recurringDay" required min="1" max="31" placeholder="例: 25 (毎月25日)" />
    </label>
    <button type="button" id="addRecurringEntryBtn" class="add-recurring-entry-btn">定期的な記録を登録</button>

    <h3>登録済みの定期的な記録</h3>
    <ul id="recurringEntryList">
      </ul>
    <button type="button" id="addMonthlyRecurringEntriesBtn">今月に定期的な記録を一括追加</button>
  </div>


  <h2 id="history-section-h2">履歴</h2>
  <div class="month-navigation">
    <button id="prevMonth">&lt;</button>
    <span id="currentMonthDisplay" class="month-display"></span>
    <input type="month" id="monthPicker" style="opacity: 0; pointer-events: none; position: absolute; width: 1px; height: 1px;">
    <button id="nextMonth">&gt;</button>
  </div>

  <div class="filter-section">
    <h3>履歴の検索・絞り込み</h3>
    <label>キーワード（メモ・タグ）：
      <input type="search" id="filterKeyword" placeholder="例: ランチ, #旅行" />
    </label>
    <label>種別：
      <select id="filterType">
        <option value="">すべて</option>
        <option value="支出">支出</option>
        <option value="収入">収入</option>
      </select>
    </label>
    <label>カテゴリ：
      <select id="filterCategory">
        <option value="">すべて</option>
        </select>
    </label>
    <label>金額（下限）：
      <input type="number" id="filterAmountMin" min="0" />
    </label>
    <label>金額（上限）：
      <input type="number" id="filterAmountMax" min="0" />
    </label>
    <div class="filter-buttons">
        <button type="button" id="searchBtn">検索</button>
        <button type="button" id="resetFilterBtn">リセット</button>
    </div>
  </div>

  <ul id="history"></ul>

  <button id="exportCsvBtn">CSVでエクスポート</button>

  <h2 id="analysis-section-h2">分析</h2>
  <div class="summary-section">
    <div class="summary-item income">
      <span>収入</span><span id="totalIncome">¥0</span>
    </div>
    <div class="summary-item expense">
      <span>支出</span><span id="totalExpense">¥0</span>
    </div>
    <hr style="margin: 1em 0; border: none; border-top: 1px solid #eee;">
    <div class="summary-item total">
      <span>合計</span><span id="balance">¥0</span>
    </div>
    <div class="budget-status" id="budgetStatus">
        <h3>今月の予算実績</h3>
        <p style="text-align: center; color: #777; font-size: 0.9em;" id="noBudgetSetMessage">予算が設定されていません。</p>
        </div>
  </div>

  <div class="chart-tabs">
    <button id="pieChartTab" class="active">カテゴリ別（円グラフ）</button>
    <button id="monthlyBarChartTab">月別推移（棒グラフ）</button>
    <button id="yearlyBarChartTab">年別推移（棒グラフ）</button>
  </div>

  <div class="chart-container">
    <canvas id="myChart"></canvas>
  </div>

  <div class="footer-nav">
    <button class="nav-button" data-target="top">
        <i class="material-icons">add_circle_outline</i>
        <span>入力</span>
    </button>
    <button class="nav-button" data-target="budget-section-h2">
        <i class="material-icons">account_balance_wallet</i>
        <span>予算</span>
    </button>
    <button class="nav-button" data-target="recurring-entry-section-h2">
        <i class="material-icons">event_note</i>
        <span>定期</span>
    </button>
    <button class="nav-button" data-target="history-section-h2">
        <i class="material-icons">history</i>
        <span>履歴</span>
    </button>
    <button class="nav-button" data-target="analysis-section-h2">
        <i class="material-icons">bar_chart</i>
        <span>分析</span>
    </button>
  </div>

  <script src="app.js"></script>

</body>
</html>
